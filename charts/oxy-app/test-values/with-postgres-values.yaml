# Integration test with PostgreSQL enabled
nameOverride: "oxy-test-postgres"
fullnameOverride: "oxy-test-postgres"

app:
  image: "ghcr.io/oxy-hq/oxy"
  imageTag: "0.3.19"
  imagePullPolicy: "IfNotPresent"

replicaCount: 1

service:
  type: ClusterIP
  port: 80
  targetPort: 80

# Enable PostgreSQL dependency
database:
  postgres:
    enabled: true
    auth:
      username: app
      password: testpass123
      database: app
    # Legacy fields for backwards compatibility
    postgresqlUsername: app
    postgresqlPassword: testpass123
    postgresqlDatabase: app

# Configure PostgreSQL for testing (CloudNativePG)
postgresql:
  type: postgresql
  cluster:
    instances: 1
    imageName: ghcr.io/cloudnative-pg/postgresql:17.2
    storage:
      size: 1Gi
      storageClass: standard
  # Configure the default app database and user that CNPG creates
  databases:
    - name: app
      owner: app
      ensure: present


resources:
  limits:
    cpu: 100m
    memory: 128Mi
  requests:
    cpu: 50m
    memory: 64Mi